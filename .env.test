# Test Environment Configuration
# This file contains environment variables specifically for running tests
# Copy this to .env.test and adjust values as needed

# SECURITY NOTICE:
# - This file contains TEST credentials only - no real secrets
# - It's safe to commit this file as it provides test environment defaults
# - For production, copy to .env and add real credentials (never commit .env)
# - The test passwords and API keys here are intentionally fake/weak
# - These test credentials are shared across all developers

# IMPORTANT: Test databases MUST be separate from production!
# These should point to dedicated test instances that can be safely wiped

# Test Database Configuration
# Uses a separate test database to prevent data loss
# When running in Docker, these will be overridden by bouy test command
TEST_DATABASE_URL=postgresql+psycopg2://postgres:pirate@db:5432/test_pantry_pirate_radio
TEST_REDIS_URL=redis://cache:6379/1

# For local development without Docker:
# TEST_DATABASE_URL=postgresql+psycopg2://postgres:pirate@localhost:5432/test_pantry_pirate_radio
# TEST_REDIS_URL=redis://localhost:6379/1

# Production URLs - kept here for safety checks
# Tests will verify these are different from TEST_ URLs
DATABASE_URL=postgresql+psycopg2://postgres:pirate@db:5432/pantry_pirate_radio
REDIS_URL=redis://cache:6379/0

# PostgreSQL password for Docker environment
POSTGRES_PASSWORD=pirate

# HSDS Validation Settings
# Confidence thresholds for data validation and inference
# Minimum confidence score for acceptance (allows smart inference)
HSDS_MIN_CONFIDENCE=0.82
# Minimum confidence score to attempt retry
HSDS_RETRY_THRESHOLD=0.65
# Maximum number of retry attempts
HSDS_MAX_RETRIES=5

# Test-specific settings
TESTING=true
DEBUG=true
LOG_LEVEL=DEBUG
DB_ECHO=true

# Disable external services in tests
PUBLISHER_PUSH_ENABLED=false
LLM_PROVIDER=test  # Use mock provider

# Test API keys (can be fake for unit tests)
OPENROUTER_API_KEY=test_key
ANTHROPIC_API_KEY=test_key

# Content store for tests
CONTENT_STORE_PATH=/tmp/test_content_store

# Output directory for tests
OUTPUT_DIR=/tmp/test_outputs

# Geocoding Configuration
# Primary provider: arcgis (default, free tier) or nominatim
GEOCODING_PROVIDER=arcgis
# Cache geocoding results for 30 days to avoid duplicate API calls
GEOCODING_CACHE_TTL=2592000
# Rate limit in seconds between requests (0.5 = 2 req/sec for ArcGIS free tier)
GEOCODING_RATE_LIMIT=0.5

# ArcGIS Authentication (optional - provides higher limits)
# Create free developer account at https://developers.arcgis.com
# With API key: 1M geocodes/month, Without: 20K geocodes/month
# Get your API key from: https://developers.arcgis.com/api-keys/
ARCGIS_API_KEY=

# Nominatim Configuration (fallback geocoder)
NOMINATIM_USER_AGENT=pantry-pirate-radio
# Must respect 1 request per second limit
NOMINATIM_RATE_LIMIT=1.1

# Geocoding Fallback Behavior
GEOCODING_ENABLE_FALLBACK=true
GEOCODING_MAX_RETRIES=3
GEOCODING_TIMEOUT=10
