{
  "title": "HAARRRvest - Food Resources Database",
  "description": "Interactive exploration of food assistance locations",
  "license": "CC0 1.0 Universal",
  "license_url": "https://creativecommons.org/publicdomain/zero/1.0/",
  "source": "Pantry Pirate Radio PostgreSQL Database",
  "source_url": "https://github.com/For-The-Greater-Good/pantry-pirate-radio",
  
  "extra_css_urls": [
    "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",
    "/static/datasette-custom.css"
  ],
  
  "extra_body_script": "window.addEventListener('DOMContentLoaded', function() { if (window.location.pathname === '/') { window.location.href = '/pantry_pirate_radio/location_master'; } });",

  "plugins": {
    "datasette-cluster-map": {
      "latitude_column": "latitude",
      "longitude_column": "longitude",
      "cluster_control": true,
      "popup_html": "<strong>{name}</strong><br>{address1}<br>{city}, {state} {postal_code}<br><a href='{url}' target='_blank'>Website</a>"
    },
    "datasette-leaflet": {
      "tile_layer": "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
      "latitude_column": "latitude",
      "longitude_column": "longitude"
    },
    "datasette-block-robots": {
      "block": true
    },
    "datasette-graphql": {
      "enable_graphiql": true
    },
    "datasette-dashboards": {
      "default_dashboard": "food-pantries"
    }
  },

  "databases": {
    "pantry_pirate_radio": {
      "tables": {
        "location_master": {
          "title": "All Food Pantry Locations",
          "description": "Comprehensive view of all food pantry locations with complete details including address, contact info, services, hours, and source tracking",
          "facets": ["city", "state_province", "validation_status"],
          "searchable_columns": ["location_name", "city", "state_province", "services"],
          "plugins": {
            "datasette-cluster-map": {
              "latitude_column": "latitude",
              "longitude_column": "longitude"
            }
          }
        },
        "organization": {
          "hidden": true
        },
        "location": {
          "hidden": true
        },
        "service": {
          "hidden": true
        },
        "service_at_location": {
          "hidden": true
        },
        "address": {
          "hidden": true
        },
        "phone": {
          "hidden": true
        },
        "schedule": {
          "hidden": true
        },
        "location_source": {
          "hidden": true
        },
        "organization_source": {
          "hidden": true
        },
        "service_source": {
          "hidden": true
        }
      },
      "queries": {
        "locations_by_city": {
          "sql": "SELECT city, count(*) as count FROM location_master GROUP BY city ORDER BY count DESC",
          "title": "Locations by City",
          "description": "Number of service locations in each city"
        },
        "locations_by_state": {
          "sql": "SELECT state_province, count(*) as count FROM location_master GROUP BY state_province ORDER BY count DESC",
          "title": "Locations by State",
          "description": "Number of service locations by state"
        },
        "multi_source_locations": {
          "sql": "SELECT location_name, address_1, city, state_province, data_sources, source_count FROM location_master WHERE source_count > 1 ORDER BY source_count DESC, location_name",
          "title": "Locations from Multiple Sources",
          "description": "Locations that appear in multiple data sources"
        }
      }
    }
  },

  "dashboards": {
    "food-pantries": {
      "title": "Food Pantry Explorer",
      "description": "Explore food pantry data across different regions",
      "layout": [
        {
          "title": "Locations Map",
          "type": "chart",
          "query": "SELECT * FROM location_master WHERE latitude IS NOT NULL AND longitude IS NOT NULL",
          "chart": {
            "plugin": "datasette-cluster-map"
          }
        },
        {
          "title": "Locations by City",
          "type": "chart",
          "query": "SELECT city, count(*) as count FROM location_master GROUP BY city ORDER BY count DESC LIMIT 10",
          "chart": {
            "type": "bar",
            "x": "city",
            "y": "count"
          }
        },
        {
          "title": "Locations by State",
          "type": "chart",
          "query": "SELECT state_province, count(*) as count FROM location_master GROUP BY state_province ORDER BY count DESC LIMIT 15",
          "chart": {
            "type": "bar",
            "x": "state_province",
            "y": "count"
          }
        },
        {
          "title": "Data Source Coverage",
          "type": "chart",
          "query": "SELECT data_sources, COUNT(*) as location_count FROM location_master GROUP BY data_sources ORDER BY location_count DESC LIMIT 10",
          "chart": {
            "type": "pie",
            "x": "data_sources",
            "y": "location_count"
          }
        }
      ]
    }
  },
  
  "custom_nav_links": [
    {
      "href": "/pantry_pirate_radio/location_master",
      "label": "üìç All Locations"
    },
    {
      "href": "https://haarrrvest.for-the-gg.org/map.html",
      "label": "üó∫Ô∏è Interactive Map"
    },
    {
      "href": "https://github.com/For-The-Greater-Good/pantry-pirate-radio",
      "label": "üè¥‚Äç‚ò†Ô∏è Pantry Pirate Radio"
    },
    {
      "href": "https://github.com/For-The-Greater-Good/HAARRRvest",
      "label": "üìä HAARRRvest Data"
    }
  ]
}
